# Day 1: 程序执行的大致流程

## 🥅 学习目标

- 理解一个 C 程序从源码到运行在 CPU 上的全过程  
- 掌握计算机系统的核心组成部分：CPU、内存、IO  
- 初步建立系统级视角，认识编译、链接、加载、执行四大阶段  

---

## 🧠 关键概念

### 程序从源码到执行的路径

一个 C 程序的执行大致流程如下：

```
C 源码 (.c)
   ↓ [预处理]
预处理后的代码 (.i)
   ↓ [编译]
汇编代码 (.s)
   ↓ [汇编]
机器指令的目标文件 (.o)
   ↓ [链接]
可执行文件 (.out / .exe / ELF)
   ↓ [加载]
装载到内存
   ↓ [执行]
由 CPU 执行
```

---

### 各阶段简要说明

- **预处理（Preprocessing）**：宏展开、头文件替换（如 `#include`, `#define`）  
- **编译（Compilation）**：将 C 源码翻译为汇编语言  
- **汇编（Assembly）**：将汇编代码转为机器指令，生成 `.o` 目标文件  
- **链接（Linking）**：多个目标文件 + 库链接为最终可执行文件  
- **加载（Loading）**：操作系统将程序加载进内存  
- **执行（Execution）**：CPU 逐条取指执行程序指令  

---

## 🧩 系统组成核心知识

| 组件     | 作用                         |
|----------|------------------------------|
| **CPU**  | 执行程序、进行计算           |
| **内存** | 存储指令和数据               |
| **I/O**  | 与外部设备通信               |

> 程序运行本质是：**CPU 不断从内存中取指令、解释并执行**

---

## 🛠️ 实践任务

编写一个简单的 `hello.c` 程序，观察从编译到执行的全过程。

```c
#include <stdio.h>

int main() {
    printf("Hello, AI Chip Journey!\n");
    return 0;
}
```

在终端中执行以下命令：

```bash
gcc -E hello.c -o hello.i       # 预处理（生成 .i 文件）
gcc -S hello.c -o hello.s       # 编译（生成汇编 .s 文件）
gcc -c hello.c -o hello.o       # 编译+汇编（生成目标文件）
gcc hello.o -o hello.out        # 链接为可执行程序
```

使用 `objdump` 查看机器码：

```bash
objdump -d hello.out
```

---

## 🧠 思考题

- 如果没有操作系统，程序还能执行吗？  
- CPU 是如何知道下一条指令的地址的？  
- 这些阶段中，哪些依赖于硬件，哪些依赖于软件？

---

## 📝 学习笔记建议

- 软件需要逐步“翻译”为硬件可理解的机器语言
- 操作系统在“加载、调度”程序中扮演关键角色
- 程序性能瓶颈往往在**内存访问延迟**或**I/O**而非 CPU
- 打通“源码 ➜ 执行”的理解路径，有助于深入芯片架构与系统优化

---

## 📚 推荐资料

- 《深入理解计算机系统（CSAPP）》第 1 章：计算机系统漫游  
- 《计算机组成与设计：硬件/软件接口》  
- [Compiler Explorer (godbolt.org)](https://godbolt.org/)：可视化查看 C 代码对应的汇编代码  
